# Ticket-Bot-V1


> ๐๏ธ ุจูุช ุชุฐุงูุฑ ุงุญุชุฑุงูู. ูุงุฆูุฉ ุงุฎุชูุงุฑ + ูููุฐุฌุ ุชุญููู ูุงูู (Claim/Close/Reopen/Delete)ุ ูุงูุฑูุฒุ ุญุงูุงุช (Waiting User/Staff)ุ ุชุฑุงูุณูุฑุจุช HTMLุ ุญุฏูุฏ ุฐููุฉุ ุชูุงุฑูุฑ ุฃุณุจูุนูุฉ.

---

## โก๏ธ ููุงุฐุง ูุฐุง ุงูุจูุชุ
- ุณุฑูุนุ ูุงุถุญุ ูุนุชูุฏ **SQLite** ุจูุง ุชุนููุฏ.
- ูุงุฌูุฉ ุญุฏูุซุฉ: **Select + Modal + Buttons + Slash**.
- ูุชูุงูู ูุน **Node 18.17+ / 20+** ู **discord.js v14**.

> **ุชูุจูู:** ุงุณุชุฎุฏุงู ุงูุจูุช ููุฏุนู ูุงูุชูุธูู ุฏุงุฎู ุณูุฑูุฑู ููุท.

---

## โจ ุงููููุฒุงุช
- **ุฃููุงุน ุงูุชุฐุงูุฑ**: ๐๏ธ Support โข ๐ณ Billing โข ๐ฅ๏ธ Technical โข ๐ข Partnership โข ๐จ Report  
- **ุชุญููู ููุฑู**: Claim โข Close (ูุน ุณุจุจ) โข Reopen (ุจุญุฏ) โข Delete  
- **ุญุงูุงุช**: Waiting on **User** / Waiting on **Staff**  
- **ูุงูุฑูุฒ**: ุชุฑุญูุจ โ ุทูุจ ุชูุงุตูู โ ุชุจุฏูู ุญุงูุฉ  
- **ุญุฏูุฏ ูููุงุจุญ**: ุญุฏู ููู ููุนุ ุญุฏู ุนุงูุ ุญุฏู ููููุ ูููุฏุงูู ุจูู ุงููุชุญุงุช  
- **ุฅุบูุงู ุชููุงุฆู**: Auto-Close ููุชุฐุงูุฑ ุงูุฎุงููุฉ ุจุนุฏ N ุณุงุนุงุช  
- **ุชูุงุฑูุฑ ุฃุณุจูุนูุฉ**: ูุชุญ/ุฅุบูุงู/ูุชูุณุท ุฒูู ุงููุนุงูุฌุฉ  
- **ุณุฌูุงุช ูุชุฑุงูุณูุฑุจุช**: HTML Transcript ูุฑูู ูู ููุงุฉ ุงูููู ุนูุฏ ุงูุฅุบูุงู  
- **ุชุฑุฌูุฉ (i18n)**: ูููุงุช JSON (ar/en)

---

## ๐งฐ ุงููุชุทูุจุงุช
- **Node.js**: 18.17+ ุฃู 20+  
- ุตูุงุญูุงุช ุงูุจูุช: Manage Channels, Read/Send, Read History, Attach Files, Use App Commands

---

> ุฃูู ุชุดุบูู: ูู ููุงุฉ ุงูููุญุฉ `panelChannelId` ูุงุถูุฉุ ููุดุฑ ุงูุจูุช ููุญุฉ ูุชุญ ุงูุชุฐุงูุฑ ุชููุงุฆููุง.

---

## ๐งโ๐ป ุงูุฃูุงูุฑ

### Slash

* `/add user:<ุนุถู>` โ ุฅุถุงูุฉ ุนุถู ููุชุฐูุฑุฉ ุงูุญุงููุฉ
* `/remove user:<ุนุถู>` โ ุฅุฒุงูุฉ ุนุถู ูู ุงูุชุฐูุฑุฉ
* `/move type:<support|billing|technical|partnership|report>` โ ููู ููุน ุงูุชุฐูุฑุฉ (ูุนุฏู ุงูุงุณู ูุงูุตูุงุญูุงุช)
* `/note text:<ูุต>` โ ููุงุญุธุฉ ููุทุงูู (Embed)
* `/stats` โ ุฅุฌูุงูู/ููุชูุญ/ูุบูู/ูุณุชูู

### ุงูุฃุฒุฑุงุฑ ูุงูููุงุฆู

* **Claim** โ ุงุณุชูุงู ุงูุชุฐูุฑุฉ
* **Close** โ ุฅุบูุงู ูุน ุณุจุจ (Modal)
* **Reopen** โ ุฅุนุงุฏุฉ ูุชุญ ุถูู ุงูุญุฏ
* **Delete** โ ุญุฐู ููุงุฆู (ุจุนุฏ ุงูุฅุบูุงู)
* **Waiting User / Waiting Staff** โ ุชุจุฏูู ุงูุญุงูุฉ
* **Macros** โ (greet / more-info / switch-state)

> ุฑุฏูุฏ ุงูุฅุฏุงุฑุฉ โุฎููุฉโ ุจุงุณุชุฎุฏุงู `MessageFlags.Ephemeral` (ูุง ุชุฒุนุฌ ุงูููุงุฉ).

---

## โ๏ธ ุงูุชูููู (config.json) โ ุดุฑุญ ููุตูู

> ุถุน **IDs ุตุญูุญุฉ** ูููููุงุช/ุงูุชุตูููุงุช/ุงูุฃุฏูุงุฑ. ุฃู ุญูู ูุงูุต = ุณููู ุบูุฑ ูุชููุน.

### 1) ูููุฉ ูุชุดุบูู

* `token`: ุชููู ุงูุจูุช ูู Developer Portal.
* `clientId`: Application (Client) ID.
* `guildId`: ุงูุณูุฑูุฑ ุงููุฏู ูุชุณุฌูู ุฃูุงูุฑ ุงูุณูุงุด.

### 2) ุงููุบุฉ

* `lang`: `"ar"` ุฃู `"en"`. ุฃุถู ููููุง ูู `locales/en.json` ูู ุญุจูุช.

### 3) ุงููููุงุช ูุงูุชุตูููุงุช

* `panelChannelId`: ุงูููุงุฉ ุงูุชู ุชูุนุฑุถ ูููุง ููุญุฉ ูุชุญ ุงูุชุฐุงูุฑ.
  **ุงูุชุฑุงุญู:** ุฎุตูุต ููุงุฉ ุซุงุจุชุฉ โ๐๏ธใปopen-ticketโ.
* `logChannelId`: ููุงุฉ ุงูููู (ูุชุญ/ุฅุบูุงู/ุญุฐู + ุชุฑุงูุณูุฑุจุช).
* `ticketsCategoryId`: ุชุตููู ุงูุชุฐุงูุฑ ุงูููุชูุญุฉ.
* `archiveCategoryId`: ุชุตููู ุงูุฃุฑุดูู (ุงุฎุชูุงุฑูุ ุชูููู ูู ุงููููุงุช ุจุนุฏ ุงูุฅุบูุงู).
* `weeklyReportChannelId`: ููุงุฉ ุงูุชูุฑูุฑ ุงูุฃุณุจูุนู.

### 4) ุงูุฃุฏูุงุฑ ูุงูุตูุงุญูุงุช

* `supportTeamRoleId`: ุฑูู ุงูุชุฑุงุถู ูู ููุน ุงูุชุฐูุฑุฉ ูุง ูู ุฑูู ุฎุงุต.
* `typeRoleIds`: ูุงุจ ูุฑุจุท ูู ููุน ุฑูู ูุนูููุ ูุซุงู:

  ```json
  "typeRoleIds": {
    "support": "ROLE_SUPPORT",
    "billing": "ROLE_BILLING",
    "technical": "ROLE_TECH",
    "partnership": "ROLE_PARTNER",
    "report": "ROLE_REPORT"
  }
  ```
* ุฃุฏูุงุฑ ุงูุฅุฏุงุฑุฉ:

  * `claimRoleId`: ูู ููุฏุฑ ูุณุชูู/ูุฏูุฑ ุงูุชุฐุงูุฑ.
  * `closeRoleId`: ูู ููุฏุฑ ูุบูู.
  * `reopenRoleId`: ูู ููุฏุฑ ูุนูุฏ ูุชุญ.
  * `deleteRoleId`: ูู ููุฏุฑ ูุญุฐู ููุงุฆู.
  * `bypassLimitRoleId`: ูุชุฌุงูุฒ ุญุฏูุฏ ุงููุชุญ/ุงููููุฏุงูู.

> **ุงูุชุฑุงุญู:** ุฎูู ุฑูู โManagementโ ููุชูู ูู ุงูุฃุฐููุงุช ุฃุนูุงูุ ูโModerationโ ููุชูู Claim/Close ููุท.

### 5) ุงูุญุฏูุฏ ูุงูุณูุงุณุงุช

* `perTypeLimit`: ุฃูุตู ุชุฐุงูุฑ **ููุชูุญุฉ** ูููุณุชุฎุฏู ุงููุงุญุฏ **ููู ููุน** (ุงูุชุฑุญ: 1).
* `globalOpenLimit`: ุฃูุตู ุชุฐุงูุฑ **ููุชูุญุฉ** ูููุณุชุฎุฏู ุงููุงุญุฏ ุนูู ูู ุงูุฃููุงุน (ุงูุชุฑุญ: 2).
* `dailyOpenLimit`: ุฃูุตู ุชุฐุงูุฑ **ุฌุฏูุฏุฉ** ุจุงูููู ูููุณุชุฎุฏู (ุงูุชุฑุญ: 3).
* `openCooldownSec`: ูููุฏุงูู ุจูู ุนูููุงุช ุงููุชุญ (ุจุงูุซูุงูู) (ุงูุชุฑุญ: 120).
* `reopenLimit`: ูุฑุงุช ุฅุนุงุฏุฉ ุงููุชุญ ูููุณ ุงูุชุฐูุฑุฉ (ุงูุชุฑุญ: 1).
* `idleAutoCloseHours`: ุฅุบูุงู ุชููุงุฆู ููุชุฐุงูุฑ ุงูุฎุงููุฉ ุจุนุฏ ุณุงุนุงุช (ุงูุชุฑุญ: 48).
* `dmOnClose`: ุฅุฑุณุงู ุฑุณุงูุฉ ุฎุงุต ูููุณุชุฎุฏู ุนูุฏ ุงูุฅุบูุงู (true/false).

### 6) ุงูุชูุงุฑูุฑ

* `weeklyReport`: ูุงุฆู ุจุงูููู/ุงูุณุงุนุฉ (UTC):

  ```json
  "weeklyReport": { "day": 0, "hour": 20 }  // ุงูุฃุญุฏ 20:00 UTC
  ```

### 7) ูุซุงู ูุงูู

```json
{
  "token": "BOT_TOKEN",
  "clientId": "APP_ID",
  "guildId": "GUILD_ID",

  "lang": "ar",

  "panelChannelId": "CHANNEL_ID",
  "logChannelId": "CHANNEL_ID",
  "ticketsCategoryId": "CATEGORY_ID",
  "archiveCategoryId": "CATEGORY_ID",
  "weeklyReportChannelId": "CHANNEL_ID",

  "supportTeamRoleId": "ROLE_FALLBACK_ID",
  "typeRoleIds": {
    "support": "ROLE_ID",
    "billing": "ROLE_ID",
    "technical": "ROLE_ID",
    "partnership": "ROLE_ID",
    "report": "ROLE_ID"
  },

  "claimRoleId": "ROLE_ID",
  "closeRoleId": "ROLE_ID",
  "reopenRoleId": "ROLE_ID",
  "deleteRoleId": "ROLE_ID",
  "bypassLimitRoleId": "ROLE_ID",

  "perTypeLimit": 1,
  "globalOpenLimit": 2,
  "dailyOpenLimit": 3,
  "openCooldownSec": 120,
  "reopenLimit": 1,
  "idleAutoCloseHours": 48,
  "dmOnClose": true,

  "weeklyReport": { "day": 0, "hour": 20 }
}
```

**ุงูุชุฑุงุญุงุชู ุงูุนูููุฉ:**

* ุงุณุชุฎุฏู ุชุตููููู ูุงุถุญูู: `๐ซ Tickets` ู `๐๏ธ Tickets Archive`.
* ุงุฌุนู ุงูููุญุฉ ููููุฉ ูููุชุงุจุฉ (View ููุท) ุญุชู ุชููู ูุธููุฉ.
* ุถุน ุงูุจูุช **ุฃุนูู** ูู ุฑุชุจ ุงูุทุงูู ุงูุชู ูุญุชุงุฌ ูููุญูุง.
* ูู ุงูููู: ูุนูู **Slowmode** ุจุณูุท (5s) ุญุชู ูุง ุชุชูุฏุณ ุฑุณุงุฆู ุงููุงูุฑูุฒ.

---

## ๐๏ธ ูุงุนุฏุฉ ุงูุจูุงูุงุช

* **SQLite** ุจููู `tickets.db` (WAL ููุนูู ููุฃุฏุงุก).
* ุงูุฌุฏุงูู:

  * `tickets(id, channelId, userId, type, status, state, createdAt, lastActivityAt, claimedBy, closedAt, reopenedCount)`
  * `actions(id, ticketId, at, action, byUser, data)`
* **ุงูุชุฑุงูุณูุฑุจุช**: ูุชู ุชูููุฏ `transcript-<ID>.html` ุนูุฏ ุงูุฅุบูุงู ูููุฑุณู ูููุงุฉ ุงูููู ููุฑูู.

**ูุตุงุฆุญ:**

* ูุณุฎ ุงุญุชูุงุทู ุฏูุฑู ูููู `tickets.db`.
* ุนูุฏ ุงูููู ูุฎุงุฏู ุฌุฏูุฏ: ุฃููู ุงูุจูุช โ ุงูุณุฎ `tickets.db` ูุงูุฑูุจู โ ุดุบูู.

---

## ๐ค ุฏุนู ูุชูุงุตู

* ุชุญููู ูู:

  * ูุณุฎุฉ Node **18.17+ / 20+**
  * ุตูุงุญูุงุช ุงูุจูุช ูู ุงููููุงุช
  * IDs ุตุญูุญุฉ ูู `config.json`
  * ุฃู ุชุตููู ุงูุชุฐุงูุฑ ููุฌูุฏ ููู ุตูุงุญูุงุช ุฅูุดุงุก ูููุงุช

> ูู ุงุญุชุฌุช ูุฑุงุฌุนุฉ ุฅุนุฏุงุฏุงุชูุ ุฃุฑุณู ููุทุฉ ูู `config.json` (ูุน ุฅุฎูุงุก ุงูุชููู).

---
